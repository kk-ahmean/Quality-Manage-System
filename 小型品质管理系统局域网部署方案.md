# 小型品质管理系统局域网部署方案

## 适用场景
- 20人以内小团队试用
- 后端和数据库均部署在一台办公电脑（Windows/Linux均可）
- 数据需持久化保存
- 其他用户通过局域网访问系统

---

## 一、环境准备

### 1. 服务器选型
- 推荐使用一台性能较好的办公电脑（建议4核8G内存及以上，Windows 10/11或Linux）
- 该电脑需始终开机，作为局域网服务端

### 2. 安装软件
- [Node.js 16.x 或更高版本](https://nodejs.org/zh-cn/download/)
- [MongoDB 4.4+](https://www.mongodb.com/try/download/community)
- [Git](https://git-scm.com/downloads)

---

## 二、系统部署

### 1. 获取项目代码
```bash
# 打开命令行，进入目标目录
cd D:/AI/File
# 克隆项目（或将代码拷贝到此目录）
git clone https://github.com/kk-ahmean/Quality-Manage-System.git
cd Quality-Manage-System
```

### 2. 安装依赖
```bash
# 安装前端依赖
npm install
# 安装后端依赖
cd server
npm install
cd ..
```

### 3. 配置MongoDB数据库
#### 3.1 启动MongoDB服务
- Windows：
  - 安装MongoDB后，启动MongoDB服务（可用MongoDB Compass或命令行）
  - 默认端口：27017
- Linux：
  ```bash
  sudo systemctl start mongod
  sudo systemctl enable mongod
  ```

#### 3.2 创建数据库和用户（可选，推荐）
```bash
mongo
use bug-management-system
db.createUser({
  user: "bugapp",
  pwd: "bugapppassword",
  roles: ["readWrite"]
})
exit
```

### 4. 配置后端环境变量
编辑 `server/config.env` 文件：
```env
MONGODB_URI=mongodb://bugapp:bugapppassword@127.0.0.1:27017/bug-management-system
JWT_SECRET=your-super-secret-jwt-key-here
PORT=5001
NODE_ENV=production
CORS_ORIGIN=http://办公电脑IP:3000
USE_MEMORY_DB=false
```
- `办公电脑IP` 替换为本机在局域网内的IP地址（如192.168.1.100）。
- 可通过命令 `ipconfig` (Windows) 或 `ifconfig` (Linux) 查看本机IP。

### 5. 启动后端服务
```bash
cd server
npm start
```
- 启动成功后，后端API地址为：`http://办公电脑IP:5001/api`

### 6. 配置前端API地址
编辑 `src/config/api.ts`，确保开发环境下前端API地址为：
```ts
baseURL: 'http://办公电脑IP:5001/api',
```
- `办公电脑IP` 替换为实际IP。
- 保存后，重新构建前端。

### 7. 构建并启动前端
```bash
# 回到项目根目录
cd ..
npm run build
# 使用静态服务器（推荐 http-server）
npm install -g http-server
http-server dist -p 3000 --cors
```
- 启动后，前端访问地址为：`http://办公电脑IP:3000/Quality-Manage-System/`

### 8. 局域网其他用户访问
- 其他电脑需与服务器在同一局域网
- 浏览器访问：`http://办公电脑IP:3000/Quality-Manage-System/`
- 推荐使用Chrome/Edge等现代浏览器

---

## 三、常见问题与注意事项

1. **防火墙设置**
   - 确保服务器电脑防火墙放行3000端口（前端）、5001端口（后端）、27017端口（MongoDB，若需远程管理）。
   - Windows防火墙可在“高级设置”中添加入站规则。

2. **IP地址变动**
   - 建议服务器电脑使用静态IP，避免重启后IP变化导致无法访问。

3. **数据备份**
   - 定期使用 `mongodump` 备份数据库：
     ```bash
     mongodump --db bug-management-system --out /path/to/backup
     ```

4. **服务自启动**
   - 可用 [pm2](https://pm2.keymetrics.io/) 管理后端服务，保证异常自动重启。
   - 前端可用 `http-server` 或 Nginx/IIS 等托管静态文件。

5. **安全建议**
   - 管理员账号密码请妥善保管。
   - MongoDB端口如无必要不对外开放。

6. **性能建议**
   - 20人以内普通办公电脑即可满足。
   - 如有大量并发或数据量增长，建议升级硬件或迁移到专用服务器。

---

## 四、快速验证
- 启动后端、前端服务后，在服务器本机和其他局域网电脑浏览器访问：
  - `http://办公电脑IP:3000/Quality-Manage-System/`
- 使用测试账号登录：`admin@example.com / 123456`
- 测试Bug、任务、用户等功能，数据应可持久保存。

---

## 五、后续扩展建议
- 如需支持更多用户或远程访问，可将后端和数据库迁移到云服务器。
- 如需HTTPS，可在前端加Nginx反向代理并配置SSL证书。
- 如需自动备份、监控、告警等功能，可集成相关开源工具。

---

**如有部署问题，可随时联系技术支持或开发者。**